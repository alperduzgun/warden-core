name: Check Runner Hardware

on:
  push:
    branches: [ feature/ci-hardware-check ]
  workflow_dispatch:

jobs:
  check-hardware:
    runs-on: ubuntu-latest
    steps:
      - name: CPU Specs
        run: |
          echo "=== CPU === "
          lscpu || echo "lscpu failed"
          echo "Cores: $(nproc)"
      - name: RAM Specs
        run: |
          echo "=== RAM === "
          free -h || echo "free failed"
      - name: Disk Specs
        run: |
          echo "=== DISK ==="
          df -h || echo "df failed"
      - name: Network Speed Test
        run: |
          echo "=== NETWORK DOWNLOAD SPEED ==="
          # Download a 100MB test file from Hetzner and measure speed
          curl -o /dev/null -s -w "Download speed: %{speed_download} Bytes/sec\nTime Total: %{time_total} sec\nTime Connect: %{time_connect} sec\n" https://speed.hetzner.de/100MB.bin
          
          echo "=== SPEEDTEST-CLI ==="
          sudo apt-get install -y speedtest-cli
          speedtest-cli --simple
